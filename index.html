<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pi Dashboard</title>
  <meta name="color-scheme" content="dark light">
  <link rel="icon" type="image/png" href="favicon.png?v=1">
  <style>
    :root {
      --bg: #0b0f14;
      --card: #121820;
      --card-hover: #1a2230;
      --text: #e6edf3;
      --muted: #9fb0c3;
      --accent: #6c8cff;
      --good: #1db954;
      --gap: clamp(14px, 3vmin, 28px);
      --radius: 22px;
      --shadow: 0 12px 36px rgba(0,0,0,.35);
      --maxw: min(1400px, 96vw);
    }

    html, body { height: 100%; margin: 0; }
    * { box-sizing: border-box; }

    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans;
      color: var(--text);
      background: radial-gradient(1200px 800px at 20% 10%, #101826 0%, var(--bg) 40%) no-repeat,
                  radial-gradient(900px 600px at 80% 90%, #0d1320 0%, var(--bg) 40%) no-repeat,
                  var(--bg);
      display: flex;
      justify-content: center;
      align-items: center;
      padding: clamp(12px, 3vmin, 28px);
    }

    .container {
      display: flex;
      align-items: center;
      justify-content: center;
      width: var(--maxw);
      gap: var(--gap);
    }

    .avatar {
      flex: 0 0 250px;
      display: flex;
      justify-content: center;
      align-items: center;
      background: none;
    }

    .avatar img {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      object-fit: cover;
      box-shadow: none;
    }

    .grid {
      flex: 1;
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: repeat(2, 1fr);
      gap: var(--gap);
      padding-block: 20px;
    }

    .widget {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: clamp(20px, 3vmin, 32px);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      min-height: 280px;
      width: 100%;
      transition: background 0.3s ease;
    }

    .widget:hover {
      background: var(--card-hover);
    }

    .title {
      font-weight: 700;
      color: var(--muted);
      margin-bottom: 12px;
    }

    .clock .time {
      font-weight: 800;
      font-size: clamp(42px, 9vmin, 86px);
    }
    .clock .date {
      color: var(--muted);
      font-size: clamp(14px, 2.2vmin, 18px);
    }

    .weather .temp {
      font-weight: 800;
      font-size: clamp(28px, 6vmin, 48px);
    }
    .weather .desc {
      color: var(--muted);
      text-transform: capitalize;
    }
    .weather img {
      width: clamp(56px, 10vmin, 96px);
      margin-bottom: 8px;
    }

    .spotify .track {
      font-weight: 700;
      font-size: clamp(18px, 2.4vmin, 24px);
    }
    .spotify .artist {
      color: var(--muted);
      margin-top: 6px;
    }
    .spotify .status {
      color: var(--good);
      font-weight: 700;
      font-size: 14px;
      margin-top: 10px;
    }

    .quote .line {
      font-weight: 800;
      font-size: clamp(18px, 3vmin, 28px);
    }
    .quote .author {
      color: var(--muted);
      margin-top: 6px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="avatar">
      <img src="favicon.png" alt="Avatar Icon" />
    </div>

    <div class="grid">
      <section class="widget clock">
        <div class="title">Hey Austin!</div>
        <div class="time" id="time">--:--</div>
        <div class="date" id="date">Loading date…</div>
      </section>

      <section class="widget weather">
        <div class="title">Weather</div>
        <img id="wx-icon" alt="" src=""/>
        <div class="temp"><span id="wx-temp">--</span>°</div>
        <div class="desc" id="wx-desc">Loading…</div>
        <div class="loc" id="wx-loc"></div>
      </section>

      <section class="widget spotify">
        <div class="title">Now Playing</div>
        <div class="track" id="np-track">—</div>
        <div class="artist" id="np-artist"></div>
        <div class="status" id="np-status">Idle</div>
      </section>

      <section class="widget quote">
        <div class="title">Daily Motivation</div>
        <div class="line" id="q-line">Loading something inspiring…</div>
        <div class="author" id="q-author"></div>
      </section>
    </div>
  </div>

  <script>
    const WEATHER = {
      apiKey: 'b7396f9258b91bb617e7cf81cbd1eed4',
      city: 'Denver,US',
      units: 'imperial'
    };

    const LASTFM = {
      apiKey: '9c086b2b9bad7436918e93fb4333141d',
      username: 'berquama'
    };

    const timeEl = document.getElementById('time');
    const dateEl = document.getElementById('date');

    function pad(n){ return n.toString().padStart(2,'0'); }
    function tick(){
      const now = new Date();
      let h = now.getHours();
      const m = pad(now.getMinutes());
      const ampm = h >= 12 ? 'PM' : 'AM';
      const h12 = ((h + 11) % 12) + 1;
      timeEl.textContent = `${h12}:${m} ${ampm}`;
      dateEl.textContent = now.toLocaleDateString(undefined, { weekday: 'long', month: 'long', day: 'numeric', year: 'numeric' });
    }
    tick(); setInterval(tick, 1000);

    async function loadWeather(){
      const u = new URL('https://api.openweathermap.org/data/2.5/weather');
      u.search = new URLSearchParams({ q: WEATHER.city, appid: WEATHER.apiKey, units: WEATHER.units }).toString();
      try {
        const r = await fetch(u);
        const j = await r.json();
        const temp = Math.round(j.main.temp);
        const desc = j.weather?.[0]?.description || '—';
        const icon = j.weather?.[0]?.icon || '01d';
        const loc = `${j.name}${j.sys?.country ? ', ' + j.sys.country : ''}`;
        document.getElementById('wx-temp').textContent = temp;
        document.getElementById('wx-desc').textContent = desc;
        document.getElementById('wx-loc').textContent = loc;
        document.getElementById('wx-icon').src = `https://openweathermap.org/img/wn/${icon}@2x.png`;
      } catch(e){
        document.getElementById('wx-temp').textContent = '--';
        document.getElementById('wx-desc').textContent = 'Error loading weather';
      }
    }

    loadWeather();

    async function loadNowPlaying(){
      const { apiKey, username } = LASTFM;
      const trackEl = document.getElementById('np-track');
      const artistEl = document.getElementById('np-artist');
      const statusEl = document.getElementById('np-status');
      const u = new URL('https://ws.audioscrobbler.com/2.0/');
      u.search = new URLSearchParams({
        method: 'user.getrecenttracks',
        user: username,
        api_key: apiKey,
        format: 'json',
        limit: 1
      }).toString();
      try {
        const r = await fetch(u);
        const j = await r.json();
        const t = j.recenttracks?.track?.[0];
        const isNow = t['@attr']?.nowplaying === 'true';
        trackEl.textContent = t.name || '—';
        artistEl.textContent = t.artist?.['#text'] || '';
        statusEl.textContent = isNow ? 'Now Playing' : 'Last Played';
      } catch(e){
        trackEl.textContent = '—';
        artistEl.textContent = 'Unable to fetch now playing';
        statusEl.textContent = 'Offline';
      }
    }

    loadNowPlaying();
    setInterval(loadNowPlaying, 30000);

    async function fetchQuote(){
      const qLine = document.getElementById('q-line');
      const qAuthor = document.getElementById('q-author');
      try {
        const r = await fetch('https://api.quotable.io/random');
        const j = await r.json();
        qLine.textContent = '“' + j.content + '”';
        qAuthor.textContent = '— ' + j.author;
      } catch(e) {
        qLine.textContent = '“Small steps, every day.”';
        qAuthor.textContent = '— Unknown';
      }
    }

    fetchQuote();
  </script>
</body>
</html>
